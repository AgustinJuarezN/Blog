"use strict";(self.webpackChunkangular_template=self.webpackChunkangular_template||[]).push([[240],{8909:(O,h,t)=>{t.d(h,{u:()=>o});var s=t(9653);const o=(0,s.R7)({source:"Article Form",events:{Reset:(0,s.uZ)(),"Publish Article":(0,s.uZ)(),"Publish Article Success":(0,s.Ky)(),"Publish Article Failure":(0,s.Ky)(),"Import Articles":(0,s.uZ)(),"Import Articles Success":(0,s.Ky)(),"Import Articles Failure":(0,s.Ky)(),"Load Importer Options":(0,s.uZ)(),"Load Importer Options Success":(0,s.Ky)(),"Load Importer Options Failure":(0,s.Ky)()}})},839:(O,h,t)=>{t.d(h,{v:()=>g});var s=t(9653),o=t(8909);const n={loaded:!1,loading:!1,error:null,importerOptions:[]},g=(0,s.Tz)({name:"articleForm",reducer:(0,s.Lq)(n,(0,s.on)(o.u.reset,()=>n),(0,s.on)(o.u.publishArticle,o.u.loadImporterOptions,o.u.importArticles,c=>({...c,loading:!0,error:null})),(0,s.on)(o.u.publishArticleSuccess,o.u.importArticlesSuccess,c=>({...c,loaded:!0,loading:!1,error:null})),(0,s.on)(o.u.loadImporterOptionsSuccess,(c,{options:p})=>({...c,importerOptions:p,loaded:!0,loading:!1,error:null})),(0,s.on)(o.u.publishArticleFailure,o.u.loadImporterOptionsFailure,o.u.importArticlesFailure,(c,p)=>({...c,loaded:!1,loading:!1,error:p.error})))})},5796:(O,h,t)=>{t.d(h,{V:()=>p});var s=t(839);const{selectLoaded:o,selectLoading:n,selectError:g,selectImporterOptions:c}=s.v,p={selectLoaded:o,selectLoading:n,selectError:g,selectImporterOptions:c}},7240:(O,h,t)=>{t.r(h),t.d(h,{default:()=>b});var s=t(9653),o=t(2260),n=t(9646),g=t(1365),c=t(4351),p=t(8505),E=t(4004),F=t(262),a=t(8909),T=t(8736),x=t(5796),e=t(4650),U=t(5257),W=t(8759),Y=t(7185);let y=(()=>{class i{getImporterNameById(r,l){const m=l.find(A=>A.id===r);return m?m.description:null}constructor(r,l,m,A,P){this.actions$=r,this.store=l,this.articlesService=m,this.router=A,this.toast=P,this.publishArticle$=(0,o.GW)(()=>this.actions$.pipe((0,o.l4)(a.u.publishArticle),(0,o.IC)(()=>this.store.select(T.L.selectData)),(0,c.b)(([u,$])=>this.articlesService.publishArticle($).pipe((0,p.b)(f=>this.router.navigate(["/private/articles",f.id])),(0,E.U)(f=>a.u.publishArticleSuccess({article:f})),(0,F.K)(f=>(0,n.of)(a.u.publishArticleFailure({error:f.error}))))))),this.importArticles$=(0,o.GW)(()=>this.actions$.pipe((0,o.l4)(a.u.importArticles),(0,g.M)(this.store.select(T.L.selectData),this.store.select(x.V.selectImporterOptions)),(0,c.b)(([u,$,f])=>{const M=this.getImporterNameById($.importerName,f);return M?this.articlesService.importArticles({importerName:M,filePath:$.filePath}).pipe((0,E.U)(D=>a.u.importArticlesSuccess({article:D})),(0,F.K)(D=>(0,n.of)(a.u.importArticlesFailure({error:D.error})))):(0,n.of)(a.u.importArticlesFailure({error:"Invalid importer ID"}))}))),this.onPublishArticleSuccess$=(0,o.GW)(()=>this.actions$.pipe((0,o.l4)(a.u.publishArticleSuccess),(0,p.b)(({article:u})=>{u.isApproved||this.toast.info("Article has been put under review because it contains offensive words. Once it is approved it will be visible for other users","Article under revision",{tapToDismiss:!1,timeOut:2e4,closeButton:!0})})),{dispatch:!1}),this.onLoadImporterOptions$=(0,o.GW)(()=>this.actions$.pipe((0,o.l4)(a.u.loadImporterOptions),(0,c.b)(()=>this.articlesService.getImporterOptions().pipe((0,E.U)(u=>a.u.loadImporterOptionsSuccess({options:u})),(0,F.K)(u=>(0,n.of)(a.u.loadImporterOptionsFailure({error:u.error})))))))}}return i.\u0275fac=function(r){return new(r||i)(e.LFG(o.eX),e.LFG(s.yh),e.LFG(U.n),e.LFG(W.F0),e.LFG(Y._W))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var C=t(839),N=t(9300),z=t(5698),B=t(1318),H=t(6155);let Z=(()=>{class i{constructor(r){this.store=r}waitForArticleToLoad(){return this.store.select(H.X.selectLoaded).pipe((0,N.h)(r=>r),(0,z.q)(1))}canActivate(r){return this.store.dispatch(B.o.loadArticle({articleId:r.params.articleId})),this.waitForArticleToLoad()}}return i.\u0275fac=function(r){return new(r||i)(e.LFG(s.yh))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var j=t(2021),J=t(8224),I=t(6895),K=t(3003),L=t(6434),S=t(6935),R=t(9841),v=t(8126),G=t(9507);let Q=(()=>{class i{constructor(r){this.store=r,this.articles$=this.store.select(v.q.selectEntities),this.loading$=this.store.select(v.q.selectLoading),this.editing$=this.store.select(v.q.selectEditing),this.vm$=(0,R.a)({articles:this.articles$,loading:this.loading$,editing:this.editing$,showFromAuthor:(0,n.of)(!0)}).pipe((0,F.K)(this.handleError))}ngOnInit(){this.store.dispatch(L.u.loadRecentArticles())}onArticleFiltered(r){this.store.dispatch(L.u.filterArticlesBy({filterBy:r,from:G.j1.Recent}))}handleError(r){return console.log("[ArticleListVM - ERROR",r),(0,n.of)(!0)}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(s.yh))},i.\u0275cmp=e.Xpm({type:i,selectors:[["home"]],standalone:!0,features:[e.jDz],decls:5,vars:1,consts:[[1,"private-page-container"],[3,"filtered"],[3,"vm$"]],template:function(r,l){1&r&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Article list"),e.qZA(),e.TgZ(3,"filter-articles",1),e.NdJ("filtered",function(A){return l.onArticleFiltered(A)}),e.qZA(),e._UZ(4,"article-list",2),e.qZA()),2&r&&(e.xp6(4),e.Q6J("vm$",l.vm$))},dependencies:[I.ez,K.D,S.P],changeDetection:0}),i})();var V=t(9450);function X(i,d){if(1&i){const r=e.EpF();e.TgZ(0,"div",1)(1,"h1"),e._uU(2),e.qZA(),e.TgZ(3,"filter-articles",2),e.NdJ("filtered",function(m){const P=e.CHM(r).ngIf,u=e.oxw();return e.KtG(u.onArticleFiltered(m,P.id))}),e.qZA(),e._UZ(4,"article-list",3),e.qZA()}if(2&i){const r=d.ngIf,l=e.oxw();e.xp6(2),e.hij("",r.firstName,"'s Article list"),e.xp6(2),e.Q6J("vm$",l.vm$)}}const b=[{path:"",component:Q},{path:"personal",component:(()=>{class i{constructor(r){this.store=r,this.articles$=this.store.select(v.q.selectEntities),this.loading$=this.store.select(v.q.selectLoading),this.editing$=this.store.select(v.q.selectEditing),this.user$=this.store.select(V.A.selectLoggedUser),this.vm$=(0,R.a)({articles:this.articles$,loading:this.loading$,editing:this.editing$,showFromAuthor:(0,n.of)(!1)}).pipe((0,F.K)(this.handleError))}ngOnInit(){this.store.dispatch(L.u.loadMyArticles())}onArticleFiltered(r,l){this.store.dispatch(L.u.filterArticlesBy({filterBy:r=`${r}&authorId=${l}`,from:G.j1.AllArticles}))}handleError(r){return console.log("[ArticleListVM - ERROR",r),(0,n.of)(!0)}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(s.yh))},i.\u0275cmp=e.Xpm({type:i,selectors:[["personal-articles"]],standalone:!0,features:[e.jDz],decls:2,vars:3,consts:[["class","private-page-container",4,"ngIf"],[1,"private-page-container"],[3,"filtered"],[3,"vm$"]],template:function(r,l){1&r&&(e.YNc(0,X,5,2,"div",0),e.ALo(1,"async")),2&r&&e.Q6J("ngIf",e.lcZ(1,1,l.user$))},dependencies:[I.ez,I.O5,I.Ov,S.P,K.D],changeDetection:0}),i})()},{path:"import",loadComponent:()=>t.e(883).then(t.bind(t,4883)),providers:[(0,s.oY)(C.v),(0,o.y3)(y)]},{path:"new",loadComponent:()=>t.e(341).then(t.bind(t,9341)),providers:[(0,s.oY)(C.v),(0,o.y3)(y)]},{path:":articleId",loadComponent:()=>Promise.all([t.e(592),t.e(324)]).then(t.bind(t,8324)),providers:[(0,s.oY)(j.H),(0,o.y3)(J.x)],canActivate:[Z]},{path:":articleId/edit",loadComponent:()=>t.e(341).then(t.bind(t,9341)),providers:[(0,s.oY)(C.v),(0,o.y3)(y)],canActivate:[Z]}]}}]);