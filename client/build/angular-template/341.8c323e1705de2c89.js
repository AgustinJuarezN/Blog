"use strict";(self.webpackChunkangular_template=self.webpackChunkangular_template||[]).push([[341],{9341:(O,h,e)=>{e.r(h),e.d(h,{default:()=>U});var f=e(6895),i=e(4281),l=e(8736),g=e(1624),v=e(2648),T=e(693),s=e(2474),c=e(4006),u=e(5593),p=e(8909),y=e(5796),F=e(7772),A=e(6155),E=e(590),I=e(1318),C=e(1724),m=(e(5032),(()=>{return(o=m||(m={}))[o.BOTTOM=0]="BOTTOM",o[o.LEFT=1]="LEFT",o[o.TOP=2]="TOP",o[o.TOP_AND_BOTTOM=3]="TOP_AND_BOTTOM",m;var o})()),t=e(4650),M=e(9653),B=e(7185),L=e(1422),Z=e(4688);const $=["dynamicForm"];function Q(o,n){1&o&&t._UZ(0,"error-badge",6),2&o&&t.Q6J("error",n.ngIf)}function N(o,n){1&o&&t._UZ(0,"loading")}const S=[{type:i.fS.TEXT,name:"title",label:"Title",placeholder:"Title",validators:[c.kI.required]},{type:i.fS.TEXTAREA,name:"content",label:"Content",validators:[c.kI.required],placeholder:"What's this article about?"},{type:i.fS.SELECT,name:"template",label:"Image Position",validators:[c.kI.required],placeholder:"Select image position",select:{options:[{id:m.BOTTOM,description:"Bottom"},{id:m.LEFT,description:"Left"},{id:m.TOP,description:"Top"},{id:m.TOP_AND_BOTTOM,description:"Top and Bottom"}]}},{type:i.fS.CHECK,name:"private",label:"Private article"},{type:i.fS.FILE_UPLOAD,name:"image",label:"Article Image",placeholder:"Only images allowed",validators:[c.kI.required],groupErrors:[{type:"imageQuantityExceeded",message:"Image quantity exceeded"},{type:"requiredImagesMissing",message:"Required images missing"}],file:{accept:"image/*"}},{type:i.fS.FORM_GROUP,name:null,validators:[o=>{const n=o.get("image"),r=o.get("template");if(r&&n&&r.value&&n.value){if(r.value===m.TOP_AND_BOTTOM){if(n.value.length<2)return{requiredImagesMissing:!0};if(n.value.length>2)return{imageQuantityExceeded:!0}}if(r.value!==m.TOP_AND_BOTTOM){if(n.value.length<1)return{requiredImagesMissing:!0};if(n.value.length>1)return{imageQuantityExceeded:!0}}}return null}]}];let U=(()=>{class o{constructor(r,a){this.store=r,this.toast=a,this.structure$=this.store.select(l.L.selectStructure),this.data$=this.store.select(l.L.selectData),this.loading$=this.store.select(y.V.selectLoading),this.error$=this.store.select(y.V.selectError),this.editing=!1}ngOnInit(){this.store.dispatch(g.i.setStructure({structure:S})),this.store.select(A.X.selectData).pipe((0,E.P)()).subscribe(r=>{r&&this.store.dispatch(g.i.setData({data:this.getFormData(r)}))})}updateForm(r){this.store.dispatch(g.i.updateData({state:r}))}submit(){this.dynamicForm.submitted(),this.dynamicForm.form.valid?this.store.dispatch(p.u.publishArticle()):this.handleInvalidForm()}getFormData(r){this.editing=!0;const a=[];return r.firstImage&&a.push({data:r.firstImage,category:"image",name:"Image 1"}),r.secondImage&&a.push({data:r.secondImage,category:"image",name:"Image 2"}),{...r,image:a}}handleInvalidForm(){this.toast.error("Form submission failed. Please correct the highlighted fields.","Error")}ngOnDestroy(){this.store.dispatch(p.u.reset()),this.store.dispatch(g.i.resetForm()),this.editing&&this.store.dispatch(I.o.reset())}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(M.yh),t.Y36(B._W))},o.\u0275cmp=t.Xpm({type:o,selectors:[["article-form"]],viewQuery:function(r,a){if(1&r&&t.Gf($,7),2&r){let d;t.iGM(d=t.CRH())&&(a.dynamicForm=d.first)}},standalone:!0,features:[t.jDz],decls:12,vars:11,consts:[[1,"private-page-container"],[3,"error",4,"ngIf"],[1,"form",3,"data$","structure$","updateForm"],["dynamicForm",""],["label","Publish Article",3,"loading","click"],[4,"ngIf"],[3,"error"]],template:function(r,a){if(1&r&&(t.TgZ(0,"section",0)(1,"h1"),t._uU(2,"Publish Article"),t.qZA(),t.YNc(3,Q,1,1,"error-badge",1),t.ALo(4,"async"),t.TgZ(5,"dynamic-form",2,3),t.NdJ("updateForm",function(J){return a.updateForm(J)}),t.qZA(),t.TgZ(7,"div")(8,"p-button",4),t.NdJ("click",function(){return a.submit()}),t.ALo(9,"async"),t.qZA()(),t.YNc(10,N,1,0,"loading",5),t.ALo(11,"async"),t.qZA()),2&r){let d;t.xp6(3),t.Q6J("ngIf",t.lcZ(4,5,a.error$)),t.xp6(2),t.Q6J("data$",a.data$)("structure$",a.structure$),t.xp6(3),t.Q6J("loading",null!==(d=t.lcZ(9,7,a.loading$))&&void 0!==d&&d),t.xp6(2),t.Q6J("ngIf",t.lcZ(11,9,a.loading$))}},dependencies:[f.ez,f.O5,f.Ov,v.N,L.r,u.hJ,u.zx,T.l,c.UX,F.$,s.I,Z.N,C.Z],styles:[".private-page-container[_ngcontent-%COMP%]{max-width:500px}"],changeDetection:0}),o})()},1724:(O,h,e)=>{e.d(h,{Z:()=>T});var f=e(6895),i=e(7772),l=e(4650);const g=function(s){return{severity:"error",summary:"Error",detail:s}},v=function(s){return[s]};let T=(()=>{class s{}return s.\u0275fac=function(u){return new(u||s)},s.\u0275cmp=l.Xpm({type:s,selectors:[["error-badge"]],inputs:{error:"error"},standalone:!0,features:[l.jDz],decls:1,vars:7,consts:[[3,"value","showTransitionOptions","hideTransitionOptions"]],template:function(u,p){1&u&&l._UZ(0,"p-messages",0),2&u&&l.Q6J("value",l.VKq(5,v,l.VKq(3,g,p.error)))("showTransitionOptions","300ms")("hideTransitionOptions","300ms")},dependencies:[f.ez,i.$,i.V],changeDetection:0}),s})()}}]);