"use strict";(self.webpackChunkangular_template=self.webpackChunkangular_template||[]).push([[324],{8324:(Te,f,a)=>{a.r(f),a.d(f,{default:()=>ye});var l=a(6895),d=a(6155),R=a(9450),h=a(9841),$=a(4004),Z=a(4281),x=a(8736),g=a(1624),v=a(2474),s=a(1318),e=a(4650),C=a(2648),_=a(5593),M=a(1422);function U(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"dynamic-form",2),e.NdJ("updateForm",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.updateForm.emit(o))}),e.qZA(),e.TgZ(2,"p-button",3),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addComment.emit({articleId:o.article.id,authorId:o.article.authorId}))}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("data$",t.data$)("structure$",t.structure$)}}let b=(()=>{class n{constructor(){this.isLoggedUserAuthor=!0,this.addComment=new e.vpe,this.updateForm=new e.vpe}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["add-comment"]],inputs:{article:"article",data$:"data$",structure$:"structure$",isLoggedUserAuthor:"isLoggedUserAuthor"},outputs:{addComment:"addComment",updateForm:"updateForm"},standalone:!0,features:[e.jDz],decls:1,vars:1,consts:[["class","add-comment-container",4,"ngIf"],[1,"add-comment-container"],[3,"data$","structure$","updateForm"],["label","Post Comment",3,"click"]],template:function(t,i){1&t&&e.YNc(0,U,3,2,"div",0),2&t&&e.Q6J("ngIf",!i.article.private||i.isLoggedUserAuthor)},dependencies:[l.ez,l.O5,C.N,M.r,_.hJ,_.zx],styles:["dynamic-form[_ngcontent-%COMP%]{margin-bottom:0}p-button[_ngcontent-%COMP%]{align-self:flex-end;margin-top:-10px}.add-comment-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}"],changeDetection:0}),n})();var j=a(3324),L=a(5698),J=a(123),A=a(8271),O=a(2524),p=(()=>{return(n=p||(p={})).Approved="approved",n.Pending="pending",n.Rejected="rejected",p;var n})(),Q=a(4538),y=a(805);let Y=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[l.ez,Q.x,y.m8,y.m8]}),n})();var K=a(1563),u=a(9507);function X(n,r){1&n&&(e.TgZ(0,"p",10),e._uU(1,"Edited"),e.qZA())}function W(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",16)(1,"p-button",17),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.articleApproved.emit(o.article.id))}),e.qZA(),e.TgZ(2,"p-button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.articleRejected.emit(o.article.id))}),e.qZA()()}2&n&&(e.xp6(1),e.Q6J("label","Approve"))}function q(n,r){if(1&n&&(e.ynx(0),e.YNc(1,W,3,1,"div",15),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.article.isApproved&&!t.article.isRejected)}}const ee=function(n){return[n]};function te(n,r){if(1&n&&(e.TgZ(0,"div",11)(1,"div",12)(2,"span",13),e._uU(3),e.qZA()(),e.YNc(4,q,2,1,"ng-container",14),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngClass",t.articleStatus),e.xp6(1),e.Oqu(t.articleStatus),e.xp6(1),e.Q6J("requiredRoles",e.VKq(3,ee,t.roleType.Admin))}}const ne=function(){return{color:"#ffffff"}};let ie=(()=>{class n{constructor(){this.hasAdminPrivileges=!1,this.isLoggedUserAuthor=!1,this.author=null,this.articleApproved=new e.vpe,this.articleRejected=new e.vpe,this.roleType=u.GD}get initials(){return this.author?this.author.firstName[0].toUpperCase()+this.author.lastName[0].toUpperCase():""}get articleStatus(){return function E(n){return n.isApproved&&!n.isRejected?p.Approved:n.isApproved||n.isRejected?!n.isApproved&&n.isRejected?p.Rejected:"undefined":p.Pending}(this.article)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["article-header"]],inputs:{hasAdminPrivileges:"hasAdminPrivileges",isLoggedUserAuthor:"isLoggedUserAuthor",author:"author",article:"article"},outputs:{articleApproved:"articleApproved",articleRejected:"articleRejected"},standalone:!0,features:[e.jDz],decls:17,vars:13,consts:[[1,"surface-section","px-4","py-5","md:px-6","lg:px-8","border-bottom-1","surface-border"],[1,"flex","align-items-start","flex-column","lg:flex-row","lg:justify-content-between","relative"],[1,"flex","align-items-start","flex-column","md:flex-row"],["shape","circle","styleClass","bg-orange-500 col",1,"mr-5","mb-3","lg:mb-0","avatar",3,"label"],[1,"text-900","font-medium","text-3xl"],[1,"flex","align-items-center","flex-wrap","text-sm"],[1,"mr-5","mt-1"],[1,"font-medium","text-500"],["class","font-medium text-500 underline font-italic",4,"ngIf"],["class","actions-container",4,"ngIf"],[1,"font-medium","text-500","underline","font-italic"],[1,"actions-container"],[1,"flex","justify-content-end"],[1,"chip","capitalize",3,"ngClass"],[4,"requiredRoles"],["class","button-bar",4,"ngIf"],[1,"button-bar"],["styleClass","p-button-outlined p-button-success p-button-sm ","icon","pi pi-check",1,"edit-button",3,"label","click"],["styleClass","p-button-outlined  p-button-danger  p-button-sm ","label","Reject","icon","pi pi-times",1,"delete-button",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"p-avatar",3),e.TgZ(4,"div")(5,"span",4),e._uU(6),e.qZA(),e.TgZ(7,"div",5)(8,"div",6)(9,"span",7),e._uU(10,"Updated at:"),e.qZA(),e.TgZ(11,"span"),e._uU(12),e.ALo(13,"ago"),e.ALo(14,"ago"),e.qZA()()(),e.YNc(15,X,2,0,"p",8),e.qZA()(),e.YNc(16,te,5,5,"div",9),e.qZA()()),2&t&&(e.xp6(3),e.Akn(e.DdM(12,ne)),e.Q6J("label",i.initials),e.xp6(3),e.AsE("",null==i.author?null:i.author.firstName," ",null==i.author?null:i.author.lastName,""),e.xp6(6),e.hij(" ",i.article.updatedAt?e.lcZ(13,8,i.article.updatedAt):e.lcZ(14,10,i.article.createdAt),""),e.xp6(3),e.Q6J("ngIf",i.article.isApproved&&i.article.updatedAt),e.xp6(1),e.Q6J("ngIf",i.hasAdminPrivileges||i.isLoggedUserAuthor))},dependencies:[l.ez,l.mk,l.O5,A.F,A.q,O.n,Y,K.O,_.hJ,_.zx],styles:["[_nghost-%COMP%]  .p-avatar.p-component.p-avatar-circle{width:90px;height:90px}[_nghost-%COMP%]  .p-avatar.p-component.p-avatar-circle .p-avatar-text{font-size:2rem}.actions-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.button-bar[_ngcontent-%COMP%]{display:flex;column-gap:10px;margin-top:25px}"],changeDetection:0}),n})();var oe=a(7967),re=a(2333);function ce(n,r){if(1&n&&e._UZ(0,"img",2),2&n){const t=e.oxw();e.Q6J("src",t.article.secondImage,e.LSH)}}const T=function(){return[]};let ae=(()=>{class n{constructor(){this.imagePosition=u.Or}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["article-body"]],inputs:{article:"article",words$:"words$"},standalone:!0,features:[e.jDz],decls:7,vars:22,consts:[[1,"title",3,"highlight","text","classToApply","innerHTML"],[1,"first-image-and-text-container","clearfix"],["alt","Article image",3,"src"],[1,"content",3,"highlight","text","classToApply","innerHTML"],["alt","Article image",3,"src",4,"ngIf"]],template:function(t,i){if(1&t&&(e._UZ(0,"h1",0),e.ALo(1,"async"),e.TgZ(2,"div",1),e._UZ(3,"img",2)(4,"p",3),e.ALo(5,"async"),e.YNc(6,ce,1,1,"img",4),e.qZA()),2&t){let o,c;e.Q6J("highlight",null!==(o=e.lcZ(1,16,i.words$))&&void 0!==o?o:e.DdM(20,T))("text",i.article.title)("classToApply","offensive-word")("innerHTML",i.article.title,e.oJD),e.xp6(2),e.ekj("image-bottom",i.article.template===i.imagePosition.Top),e.xp6(1),e.ekj("image-left",i.article.template===i.imagePosition.Left),e.Q6J("src",i.article.firstImage,e.LSH),e.xp6(1),e.ekj("text-right",i.article.template===i.imagePosition.Left),e.Q6J("highlight",null!==(c=e.lcZ(5,18,i.words$))&&void 0!==c?c:e.DdM(21,T))("text",i.article.content)("classToApply","offensive-word")("innerHTML",i.article.content,e.oJD),e.xp6(2),e.Q6J("ngIf",i.article.template===i.imagePosition.TopAndBottom)}},dependencies:[l.ez,l.O5,l.Ov,v.I,C.N,re.Z],styles:['img[_ngcontent-%COMP%]{width:100%;max-height:300px}.image-bottom[_ngcontent-%COMP%]{display:flex;flex-direction:column-reverse}.image-left[_ngcontent-%COMP%]{max-width:60%;float:left;margin:5px;border-radius:999999999999px}.text-right[_ngcontent-%COMP%]{text-align:justify}.private-page-container[_ngcontent-%COMP%]{max-width:1000px}.content[_ngcontent-%COMP%]{margin-top:10px;font-family:Lato,"sans-serif";font-weight:300}.body[_ngcontent-%COMP%]{margin-bottom:10px}.clearfix[_ngcontent-%COMP%]:after{content:"";display:table;clear:both}'],changeDetection:0}),n})();var le=a(1098),I=a(1795),w=a(8759),pe=a(9653),me=a(4688);function de(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"add-comment",9),e.NdJ("addComment",function(o){e.CHM(t);const c=e.oxw(4);return e.KtG(c.submit(o))})("updateForm",function(o){e.CHM(t);const c=e.oxw(4);return e.KtG(c.updateForm(o))}),e.qZA()}if(2&n){const t=e.oxw(3).ngIf,i=e.oxw();e.Q6J("isLoggedUserAuthor",i.isLoggedUserAuthor(t.loggedUser,t.article))("article",t.article)("data$",i.data$)("structure$",i.structure$)}}function _e(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"article-comment",11),e.NdJ("commentApproved",function(o){e.CHM(t);const c=e.oxw(4).ngIf,m=e.oxw();return e.KtG(m.onCommentApprove(o,c.article.id))})("commentRejected",function(o){e.CHM(t);const c=e.oxw(4).ngIf,m=e.oxw();return e.KtG(m.onCommentReject(o,c.article.id))})("commentReplied",function(o){e.CHM(t);const c=e.oxw(4).ngIf,m=e.oxw();return e.KtG(m.onCommentReply(o,c.article.id))})("openedReplyBox",function(o){e.CHM(t);const c=e.oxw(5);return e.KtG(c.onReplyBoxOpened(o))})("closedReplyBox",function(){e.CHM(t);const o=e.oxw(5);return e.KtG(o.onReplyBoxClosed())}),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(3).ngIf,o=e.oxw();e.Q6J("comment",t)("words$",o.words$)("openedReplyBox$",o.openedReplyBox$)("canReply",o.isLoggedUserAuthor(i.loggedUser,i.article))("hasAdminPrivileges",o.isAdmin(i.loggedUser))}}function ge(n,r){if(1&n&&(e.ynx(0),e.YNc(1,_e,1,5,"article-comment",10),e.BQk()),2&n){const t=r.$implicit,i=e.oxw(3).ngIf,o=e.oxw();e.xp6(1),e.Q6J("ngIf",t.isApproved||o.isAdmin(i.loggedUser))}}function ue(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"article-header",5),e.NdJ("articleApproved",function(o){e.CHM(t);const c=e.oxw(3);return e.KtG(c.onArticleApprove(o))})("articleRejected",function(o){e.CHM(t);const c=e.oxw(3);return e.KtG(c.onArticleReject(o))}),e.qZA(),e._UZ(2,"article-body",6),e.YNc(3,de,1,4,"add-comment",7),e.YNc(4,ge,2,1,"ng-container",8),e.BQk()}if(2&n){const t=e.oxw(2).ngIf,i=e.oxw();e.xp6(1),e.Q6J("author",t.author)("article",t.article)("hasAdminPrivileges",i.isAdmin(t.loggedUser))("isLoggedUserAuthor",i.isLoggedUserAuthor(t.loggedUser,t.article)),e.xp6(1),e.Q6J("article",t.article)("words$",i.words$),e.xp6(1),e.Q6J("ngIf",t.article.isApproved),e.xp6(1),e.Q6J("ngForOf",t.article.comments)}}function fe(n,r){1&n&&e._UZ(0,"loading")}function he(n,r){if(1&n&&(e.ynx(0),e.YNc(1,ue,5,8,"ng-container",4),e.YNc(2,fe,1,0,"loading",2),e.BQk()),2&n){const t=e.oxw().ngIf,i=e.MAs(3);e.xp6(1),e.Q6J("ngIf",!t.article.isRejected)("ngIfElse",i),e.xp6(1),e.Q6J("ngIf",t.loading)}}const xe=function(){return{exact:!0}};function ve(n,r){1&n&&(e.TgZ(0,"div",12)(1,"h1",13),e._uU(2,"Article rejected"),e.qZA(),e.TgZ(3,"a",14),e._UZ(4,"span",15),e.TgZ(5,"span",16),e._uU(6,"Go home"),e.qZA()()()),2&n&&(e.xp6(3),e.Q6J("routerLink","/private/articles")("routerLinkActiveOptions",e.DdM(2,xe)))}function Ce(n,r){if(1&n&&(e.TgZ(0,"article",1),e.YNc(1,he,3,3,"ng-container",2),e.YNc(2,ve,7,3,"ng-template",null,3,e.W1O),e.qZA()),2&n){const t=r.ngIf;e.xp6(1),e.Q6J("ngIf",t.article)}}const Ae=[{type:Z.fS.TEXTAREA,name:"comment",placeholder:"What are your thoughts?"}];let ye=(()=>{class n{constructor(t){this.store=t,this.article$=this.store.select(d.X.selectData),this.loading$=this.store.select(d.X.selectLoading),this.error$=this.store.select(d.X.selectError),this.loggedUser$=this.store.select(R.A.selectLoggedUser),this.author$=this.store.select(J.v.selectData),this.vm$=(0,h.a)({article:this.article$,loading:this.loading$,error:this.error$,loggedUser:this.loggedUser$,author:this.author$}),this.words$=this.store.select(le.y.selectEntities),this.openedReplyBox$=this.store.select(d.X.selectOpenedReplyBox),this.structure$=this.store.select(x.L.selectStructure),this.data$=this.store.select(x.L.selectData)}ngOnInit(){this.store.dispatch(g.i.setStructure({structure:Ae})),this.store.dispatch(g.i.setData({data:""})),this.handleInitializationActions()}ngOnDestroy(){this.store.dispatch(s.o.reset())}updateForm(t){this.store.dispatch(g.i.updateData({state:t}))}submit(t){const{articleId:i,authorId:o}=t;this.store.dispatch(s.o.addComment({articleId:i,authorId:o}))}onArticleApprove(t){this.store.dispatch(s.o.approveArticle({articleId:t}))}onArticleReject(t){this.store.dispatch(s.o.rejectArticle({articleId:t}))}onCommentApprove(t,i){this.store.dispatch(s.o.approveArticleComment({commentId:t,articleId:i}))}onCommentReject(t,i){this.store.dispatch(s.o.rejectArticleComment({commentId:t,articleId:i}))}onCommentReply(t,i){this.store.dispatch(s.o.addReply({commentReply:t,articleId:i}))}onReplyBoxOpened(t){this.store.dispatch(s.o.openReplyBox({commentId:t}))}onReplyBoxClosed(){this.store.dispatch(s.o.closeReplyBox())}isAdmin(t){return function se(n){return n.every(r=>n.includes(u.GD.Admin))}(t.roles)}isLoggedUserAuthor(t,i){return t?.id===i.authorId}handleInitializationActions(){(0,h.a)([this.article$,this.loggedUser$]).pipe((0,L.q)(1),(0,$.U)(([t,i])=>({article:t,loggedUser:i}))).subscribe(({article:t,loggedUser:i})=>{t&&t.authorId&&(this.store.dispatch(j.h.loadUser({userId:t.authorId})),i&&t.authorId===i.id&&this.store.dispatch(s.o.markAllCommentsAsViewed()))})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(pe.yh))},n.\u0275cmp=e.Xpm({type:n,selectors:[["article-page"]],standalone:!0,features:[e.jDz],decls:2,vars:3,consts:[["class","private-page-container",4,"ngIf"],[1,"private-page-container"],[4,"ngIf"],["articleRejectedTemplate",""],[4,"ngIf","ngIfElse"],[3,"author","article","hasAdminPrivileges","isLoggedUserAuthor","articleApproved","articleRejected"],[3,"article","words$"],[3,"isLoggedUserAuthor","article","data$","structure$","addComment","updateForm",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"isLoggedUserAuthor","article","data$","structure$","addComment","updateForm"],[3,"comment","words$","openedReplyBox$","canReply","hasAdminPrivileges","commentApproved","commentRejected","commentReplied","openedReplyBox","closedReplyBox",4,"ngIf"],[3,"comment","words$","openedReplyBox$","canReply","hasAdminPrivileges","commentApproved","commentRejected","commentReplied","openedReplyBox","closedReplyBox"],[1,"flex","flex-column","justify-content-center"],[1,"underline","text-red-500"],["pRipple","","routerLinkActive","border-blue-500",1,"align-self-center","cursor-pointer","text-center","h-full","inline-flex","align-items-center","text-600","hover:border-500","transition-colors","transition-duration-150","py-3","lg:py-0","px-3","no-underline",3,"routerLink","routerLinkActiveOptions"],[1,"pi","pi-home","mr-2"],[1,"font-medium"]],template:function(t,i){1&t&&(e.YNc(0,Ce,4,1,"article",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[l.ez,l.sg,l.O5,l.Ov,b,v.I,me.N,ie,oe.X,ae,I.T,I.H,w.rH,w.Od],changeDetection:0}),n})()}}]);